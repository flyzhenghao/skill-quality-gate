# 评分维度说明

本文档详细解释 Skill 质量门禁评估系统使用的各个评分维度。

## 概览

质量评估从 6 个维度进行：

| 维度 | 权重 | 满分 |
|------|------|------|
| 代码质量 | 25% | 25 分 |
| 文档质量 | 20% | 20 分 |
| 安全性 | 30% | 30 分 |
| 功能完整性 | 15% | 15 分 |
| 可维护性 | 5% | 5 分 |
| 社区认可 | 5% | 5 分 |

---

## 1. 代码质量 (25 分)

评估 Skill 代码的结构质量和可读性。

### 检查项

#### SKILL.md 结构 (5 分)
- **5 分**：结构良好的 SKILL.md，50+ 行
- **3 分**：基本的 SKILL.md，20-49 行
- **1 分**：最小化的 SKILL.md，<20 行
- **0 分**：缺少 SKILL.md（严重问题）

#### 脚本结构 (5 分)
- **+2 分**：有正确的 shebang（#!/bin/bash）
- **+2 分**：使用 set -e 或类似的错误处理
- **+1 分**：文件组织清晰

#### 代码规模 (5 分)
排除 `data/`、`node_modules/` 和 `.git/` 目录。

- **5 分**：< 500 行（最佳）
- **3 分**：500-1000 行（可接受）
- **1 分**：> 1000 行（建议审查）

#### 注释覆盖率 (5 分)
- **5 分**：> 15% 注释比例
- **4 分**：10-15% 注释比例
- **2 分**：5-10% 注释比例
- **1 分**：< 5% 注释比例

---

## 2. 文档质量 (20 分)

评估文档的完整性和清晰度。

### 检查项

#### 有描述说明 (4 分)
搜索关键词：`description`、`overview`、`purpose`、`about`

#### 有触发条件 (4 分)
搜索关键词：`trigger`、`when to use`、`activation`、`invoked`

#### 有使用示例 (4 分)
搜索关键词：`example`、`usage`、`demo`、`sample`

#### 有参数文档 (4 分)
搜索关键词：`parameter`、`argument`、`option`、`input`、`config`

#### 有 README.md (4 分)
检查根目录是否有 `README.md` 或 `readme.md`。

---

## 3. 安全性 (30 分)

权重最高的维度。如果可用，会调用安全审计脚本。

### 评分逻辑

- **基础分**：30 分
- **扣分**：
  - 每个 CRITICAL 问题：-10 分（最多扣 25 分）
  - 1-2 个 HIGH 问题：-5 分
  - 3+ 个 HIGH 问题：-10 分
  - 每个 MEDIUM 问题：-1 分

### CRITICAL 级别模式
- `rm -rf` 针对系统目录
- `sudo` 命令
- 读取凭证文件
- 通过 curl/wget 外发数据
- Netcat 反向 shell
- 动态输入的 eval
- Cron/LaunchAgent 持久化

### HIGH 级别模式
- 通用 `rm -rf` 使用
- `chmod 777`
- 动态命令执行
- 十六进制编码内容
- Base64 解码操作

### MEDIUM 级别模式
- 网络请求（curl/wget）
- 环境变量访问
- 动态路径文件写入

---

## 4. 功能完整性 (15 分)

评估 Skill 是否完整可用。

### 检查项

#### 有依赖文档 (4 分)
- 使用包管理器（npm、pip、brew、apt）时检查是否有依赖说明
- 没有外部依赖的 Skill 得满分

#### 有错误处理 (4 分)
搜索模式：`set -e`、`trap`、`try`、`catch`、`except`、`|| exit`、`if [`

#### 有格式化输出 (4 分)
搜索模式：`echo`、`print`、`console.log`、`format`

#### 无死代码 (3 分)
启发式检查未使用的函数。

---

## 5. 可维护性 (5 分)

评估 Skill 的长期可用性。

### 检查项

#### 流行度 (2 分)
数据来源：skill-manager 数据库或 GitHub API

- **2 分**：> 100 stars
- **1 分**：> 10 stars

#### 版本追踪 (2 分)
搜索关键词：`version`、`changelog`、`v[0-9]`

#### 最近更新 (1 分)
- 检查 git 历史（如果可用）
- **1 分**：180 天内有更新

---

## 6. 社区认可 (5 分)

评估社区信任度和采用情况。

### 检查项

#### 官方来源 (3 分)
- 来自 `anthropic` 或标记为 `official` 得满分
- 在 package.json 中有作者信息得部分分

#### 安装数量 (2 分)
数据来源：skill-manager 数据库

- **2 分**：> 100 次安装
- **1 分**：> 10 次安装

---

## 等级划分

| 分数范围 | 等级 | 星级 | 建议 |
|----------|------|------|------|
| 90-100 | 优秀 | 5/5 | 强烈推荐 |
| 75-89 | 良好 | 4/5 | 推荐 |
| 60-74 | 可用 | 3/5 | 可用但有改进空间 |
| 40-59 | 较差 | 2/5 | 需要优化 |
| 0-39 | 不推荐 | 1/5 | 不要安装 |

---

## 退出码

| 退出码 | 条件 | 含义 |
|--------|------|------|
| 0 | 分数 >= 60 | 可以安装 |
| 1 | 分数 40-59 | 需要用户决定 |
| 2 | 分数 < 40 或有严重问题 | 不要安装 |

---

## 自定义配置

你可以通过编辑 `data/scoring-rules.json` 自定义评分规则：

```json
{
  "dimensions": {
    "code_quality": {
      "weight": 25,
      "checks": {
        "skill_md_structure": {
          "max_points": 5,
          "thresholds": {
            "excellent": { "min_lines": 50, "points": 5 }
          }
        }
      }
    }
  }
}
```

---

## 局限性

1. **仅静态分析**：无法检测运行时问题
2. **启发式方法**：某些检查使用模式匹配，可能遗漏边界情况
3. **数据库依赖**：没有 skill-manager 数据库时，可维护性和社区评分可能受限
4. **无网络验证**：不会验证 URL 是否真正恶意

无论质量评分如何，请始终手动审查源代码。
